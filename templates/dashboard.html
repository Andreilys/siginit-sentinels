{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">Intelligence Map</h5>
            </div>
            <div class="card-body">
                <div class="row mb-4">
                    <div class="col-md-3">
                        <select class="form-select" id="intel-type-filter">
                            <option value="">All Intelligence Types</option>
                            <option value="IMINT">IMINT (Imagery Intelligence)</option>
                            <option value="SIGINT">SIGINT (Signals Intelligence)</option>
                            <option value="HUMINT">HUMINT (Human Intelligence)</option>
                            <option value="OSINT">OSINT (Open Source Intelligence)</option>
                            <option value="CYBERINT">CYBERINT (Cyber Intelligence)</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="intel-subtype-filter">
                            <option value="">All Subtypes</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="source-reliability-filter">
                            <option value="">All Source Reliability</option>
                            <option value="A">A - Completely Reliable</option>
                            <option value="B">B - Usually Reliable</option>
                            <option value="C">C - Fairly Reliable</option>
                            <option value="D">D - Not Usually Reliable</option>
                            <option value="E">E - Unreliable</option>
                            <option value="F">F - Cannot be Judged</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="info-credibility-filter">
                            <option value="">All Information Credibility</option>
                            <option value="ONE">1 - Confirmed</option>
                            <option value="TWO">2 - Probably True</option>
                            <option value="THREE">3 - Possibly True</option>
                            <option value="FOUR">4 - Doubtful</option>
                            <option value="FIVE">5 - Improbable</option>
                            <option value="SIX">6 - Cannot be Judged</option>
                        </select>
                    </div>
                </div>
                <div id="map" style="height: 500px;"></div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title">Recent Alerts</h5>
            </div>
            <div class="card-body">
                <div id="alerts-container">
                    {% for alert in alerts %}
                    <div class="alert alert-{{ 'danger' if alert.priority == 1 else 'warning' if alert.priority == 2 else 'info' }}">
                        <h6>{{ alert.title }}</h6>
                        <small>{{ alert.timestamp.strftime('%Y-%m-%d %H:%M') }}</small>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">Threat Level</h5>
            </div>
            <div class="card-body">
                <div class="progress">
                    <div class="progress-bar bg-danger" role="progressbar" style="width: {{ threat_level }}%"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">Intelligence Timeline</h5>
            </div>
            <div class="card-body">
                <div id="intel-timeline" class="timeline-container">
                    <!-- Timeline items will be added here dynamically -->
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/map.js') }}"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
